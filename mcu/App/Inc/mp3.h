#pragma once
#include "page/mp3_page.h"


struct mp3_state {
    bool enabled;
    bool play_state;
    bool volume_set_state;
    uint16_t current_time;
};


class mp3 {
    public:
    uint16_t& music_id;
    uint16_t current_music_id;
    uint8_t volume;
    volatile mp3_state& state;
    static mp3 & Get_Instance();
    mp3(const mp3&) = delete;
    mp3& operator=(const mp3&) = delete;
    void Transit_State();
    void Set_Play_Music() const;
    void Set_Volume() const;
    static void Increase_The_Volume();
    static void Decrease_The_Volume();
    void Show_Time();
    void Show_Volume();
    void Start();
    void Stop();
    static void Reset();
private:
    mp3(volatile mp3_state & state, const uint8_t volume, uint16_t& music_id,uint16_t current_music_id);
    static void Send_Command(const uint8_t* Data,const uint8_t& len);
    static uint8_t Get_Check_Num(const uint8_t *Data, const uint8_t &num);
};

struct music_info
{
    const char *title;
    const uint8_t *album;
    uint16_t time;
};

constexpr uint8_t MUSIC_NUM=3;

extern music_info Song_List[];

constexpr uint8_t album[][288]={

    0X00,0X00,0X00,0X00,0X00,0X00,0X80,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X80,0X03,
    0X00,0X00,0X00,0X00,0XC0,0X07,0X00,0X00,0X00,0X00,0XE0,0X0D,0X00,0X00,0X00,0X00,
    0XE0,0X01,0X00,0X00,0X00,0X00,0X60,0X03,0X00,0X00,0X00,0X00,0XE0,0X07,0X00,0X00,
    0X00,0X00,0XC0,0X06,0X00,0X00,0X00,0X00,0XFC,0X03,0X00,0X00,0X01,0X00,0XBE,0X01,
    0X00,0X00,0X01,0X00,0XDE,0X01,0X00,0X00,0X0B,0X00,0XFF,0X03,0X00,0X00,0X0F,0X00,
    0XFF,0X0B,0X00,0X00,0X5F,0X00,0XFF,0X19,0X00,0X00,0X7F,0X01,0XFF,0X19,0X00,0X00,
    0XFF,0X03,0XFF,0X1D,0X00,0X00,0XFF,0X0F,0XFF,0X1D,0X00,0X80,0XFF,0X8F,0XFF,0X1D,
    0X00,0XF0,0XFF,0X9F,0XFF,0X0D,0X00,0XF0,0XFF,0X7F,0XFF,0X0D,0X00,0XFC,0XFF,0XFF,
    0XFF,0X0D,0XF8,0XFD,0XFF,0XFF,0XFF,0X0D,0XFE,0XFE,0XFF,0XFF,0XFF,0X3D,0X7F,0XFE,
    0XFF,0XFF,0XFF,0XBF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,
    0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,
    0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,
    0XFF,0X7F,0XFF,0XFD,0XFF,0XFF,0XFF,0X7F,0XFF,0XDE,0XFF,0XFF,0XFF,0X3F,0X67,0XB6,
    0XFF,0XFF,0XFF,0X7F,0X69,0XEE,0XFF,0XFF,0XFF,0X5F,0X69,0XE7,0XFF,0XFF,0XFF,0XFF,
    0XF7,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,
    0XFF,0X7F,0XEA,0XEF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,
    0XFF,0XFF,0XFF,0XFF,0X7F,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFB,0XFF,0XFF,0XFF,0XFF,
    0X7F,0XFE,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,


    0X00,0X00,0X00,0X00,0X00,0X00,0XD0,0X00,0X00,0X00,0X00,0X00,0X81,0X00,0X6E,0X00,
    0X00,0X00,0X41,0X00,0X7F,0X00,0X00,0X00,0X47,0X00,0XFF,0X00,0X00,0X00,0X87,0X01,
    0X7F,0X00,0X80,0X01,0X87,0X03,0X76,0X00,0X00,0X00,0XFF,0X01,0X5E,0X00,0X00,0X00,
    0X8F,0X00,0X0E,0X00,0X00,0XD2,0X97,0XC0,0X5E,0X00,0X00,0X08,0X17,0X80,0X0E,0X00,
    0X00,0X02,0X1F,0XE0,0X1F,0X00,0X00,0X00,0X0F,0XB0,0X2B,0X00,0X00,0X00,0X06,0XF0,
    0X13,0X00,0X00,0X00,0X03,0XC0,0X2F,0X00,0X00,0X00,0X0B,0X80,0X1F,0X00,0X00,0X00,
    0X0F,0XC0,0X3F,0X00,0X00,0X00,0X0F,0XE0,0X1F,0X00,0X00,0X00,0X8F,0XF0,0X1F,0X00,
    0X00,0X00,0X1F,0XF0,0X1F,0X00,0X00,0X00,0X97,0XB8,0X3F,0X00,0X00,0X00,0XFF,0XB8,
    0X3F,0X00,0X02,0X00,0X77,0X98,0X1F,0X00,0X00,0X00,0X7F,0X9C,0X3F,0X00,0X00,0X00,
    0XF7,0X8C,0X1F,0X00,0X00,0X00,0X7F,0XCF,0X3F,0X00,0X00,0X00,0X2F,0XCF,0X2F,0X00,
    0X00,0X00,0X7F,0XCF,0X3F,0X00,0X00,0X00,0X47,0XBE,0X7F,0X00,0X00,0X00,0X77,0X8F,
    0XFF,0X00,0X00,0X80,0XCF,0XAE,0X7F,0X00,0X00,0X80,0X2F,0X0E,0XFF,0X00,0X00,0X84,
    0X1F,0X84,0XFF,0X00,0X00,0X84,0XD7,0X50,0XFF,0X00,0X00,0X86,0X7F,0X50,0XFF,0X01,
    0X00,0XC6,0XEF,0X40,0XED,0X01,0X00,0X7C,0X3F,0XC4,0XCD,0X01,0X00,0XCE,0XFF,0X88,
    0XCF,0X03,0X00,0X8E,0XFF,0XFF,0XC7,0X01,0X80,0X07,0XFF,0XFD,0XC5,0X01,0X80,0X07,
    0XFF,0XFD,0XDE,0X07,0X80,0X07,0XBF,0XFF,0XF9,0X2F,0X80,0X05,0XDF,0XFE,0XFF,0X1D,
    0X80,0X07,0XFF,0XFE,0XFF,0X1C,0X00,0X07,0XFF,0XEE,0XFF,0X00,0X90,0X47,0XFF,0XD0,
    0XFF,0X00,0X50,0XC2,0XFF,0X84,0XEF,0X07,0XF6,0XA0,0XFF,0X88,0XF7,0X0C,0X78,0X80,


    0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
    0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
    0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X80,0X80,0X00,0X00,0X00,0X00,0X80,0X00,0X00,
    0X00,0X02,0X10,0X80,0X00,0X00,0X10,0X02,0X00,0X80,0X00,0X00,0X00,0X00,0X00,0X00,
    0X00,0X00,0XB9,0X5B,0X3E,0XEF,0XCF,0XAF,0XB1,0X58,0X2A,0XA9,0XC2,0XAA,0XB1,0X5B,
    0X12,0X69,0XC6,0XAA,0XB1,0X50,0X12,0X69,0X82,0XAA,0XB1,0X5C,0X12,0XA9,0X82,0XAA,
    0XB1,0X54,0XF2,0XA9,0X82,0XAA,0XD1,0XD7,0XF6,0X2F,0X8F,0XCC,0X00,0X00,0XFC,0X3F,
    0X00,0X00,0X00,0X00,0XFC,0X7F,0X00,0X00,0X00,0X00,0XFE,0X7F,0X00,0X00,0X00,0X00,
    0XFE,0XFF,0X00,0X00,0X00,0X00,0XFF,0XFF,0X00,0X00,0X00,0X00,0XFF,0XFF,0X01,0X00,
    0X00,0X00,0XFF,0XFF,0X01,0X00,0X00,0X80,0XFF,0XFF,0X03,0X00,0X00,0X80,0XFF,0XFF,
    0X03,0X00,0X00,0X80,0XFF,0XFF,0X01,0X00,0X00,0X80,0X7F,0XC9,0X01,0X00,0X00,0X80,
    0X1F,0XC0,0X03,0X00,0X00,0X80,0X1F,0XC0,0X03,0X00,0X00,0X80,0X3F,0XE0,0X03,0X00,
    0X00,0XC0,0X7F,0XE0,0X01,0X00,0X00,0XC0,0X1F,0XE0,0X00,0X00,0X00,0X80,0X2F,0XC0,
    0X01,0X00,0X00,0X80,0X0F,0X90,0X00,0X00,0X00,0X80,0X5F,0X82,0X02,0X00,0X00,0X80,
    0X2F,0X80,0X03,0X00,0X00,0XE0,0X2F,0XC9,0X01,0X00,0X00,0XC0,0X8F,0XCF,0X01,0X00,
    0X00,0XC0,0X3F,0XCF,0X01,0X00,0X00,0XC2,0X3F,0XFF,0X00,0X00,0X00,0XC2,0X7F,0XE7,
    0X00,0X00,0X00,0XC6,0XFF,0X5F,0X00,0X00,0X00,0XCC,0XFF,0X43,0X00,0X00,0X00,0XCC,
    0X3F,0X43,0X00,0X00,0X00,0X9C,0X3F,0XC3,0X00,0X00,0X00,0X3C,0X3F,0XF1,0X00,0X00,

};

